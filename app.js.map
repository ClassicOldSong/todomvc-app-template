{"version":3,"file":"app.js","sources":["node_modules/classlist-polyfill/src/index.js","node_modules/ef-core/src/lib/utils/array-helper.js","node_modules/ef-core/src/lib/render-queue.js","node_modules/ef-core/src/lib/utils/polyfills.js","node_modules/ef-core/src/lib/resolver.js","node_modules/ef-core/src/lib/subscriber-call-stack.js","node_modules/ef-core/src/lib/utils/isnan.js","node_modules/ef-core/src/lib/binding.js","node_modules/ef-core/src/lib/utils/event-helper.js","node_modules/ef-core/src/lib/utils/literals-mix.js","node_modules/ef-core/src/lib/element-creator.js","node_modules/ef-core/src/lib/utils/dom-helper.js","node_modules/ef-core/src/lib/utils/dom-arr-helper.js","node_modules/ef-core/src/lib/utils/type-of.js","node_modules/ef-core/src/lib/creator.js","node_modules/ef-core/src/mount-options.js","node_modules/ef-core/src/lib/renderer.js","node_modules/ef-core/src/ef-core.js","src/array-helper.js","src/templates/todoapp.js","src/app.js"],"sourcesContent":["/*\n * classList.js: Cross-browser full element.classList implementation.\n * 1.1.20170427\n *\n * By Eli Grey, http://eligrey.com\n * License: Dedicated to the public domain.\n *   See https://github.com/eligrey/classList.js/blob/master/LICENSE.md\n */\n\n/*global self, document, DOMException */\n\n/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */\n\nif (\"document\" in window.self) {\n\n// Full polyfill for browsers with no classList support\n// Including IE < Edge missing SVGElement.classList\nif (!(\"classList\" in document.createElement(\"_\")) \n\t|| document.createElementNS && !(\"classList\" in document.createElementNS(\"http://www.w3.org/2000/svg\",\"g\"))) {\n\n(function (view) {\n\n\"use strict\";\n\nif (!('Element' in view)) return;\n\nvar\n\t  classListProp = \"classList\"\n\t, protoProp = \"prototype\"\n\t, elemCtrProto = view.Element[protoProp]\n\t, objCtr = Object\n\t, strTrim = String[protoProp].trim || function () {\n\t\treturn this.replace(/^\\s+|\\s+$/g, \"\");\n\t}\n\t, arrIndexOf = Array[protoProp].indexOf || function (item) {\n\t\tvar\n\t\t\t  i = 0\n\t\t\t, len = this.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tif (i in this && this[i] === item) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\t// Vendors: please allow content code to instantiate DOMExceptions\n\t, DOMEx = function (type, message) {\n\t\tthis.name = type;\n\t\tthis.code = DOMException[type];\n\t\tthis.message = message;\n\t}\n\t, checkTokenAndGetIndex = function (classList, token) {\n\t\tif (token === \"\") {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"SYNTAX_ERR\"\n\t\t\t\t, \"An invalid or illegal string was specified\"\n\t\t\t);\n\t\t}\n\t\tif (/\\s/.test(token)) {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"INVALID_CHARACTER_ERR\"\n\t\t\t\t, \"String contains an invalid character\"\n\t\t\t);\n\t\t}\n\t\treturn arrIndexOf.call(classList, token);\n\t}\n\t, ClassList = function (elem) {\n\t\tvar\n\t\t\t  trimmedClasses = strTrim.call(elem.getAttribute(\"class\") || \"\")\n\t\t\t, classes = trimmedClasses ? trimmedClasses.split(/\\s+/) : []\n\t\t\t, i = 0\n\t\t\t, len = classes.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tthis.push(classes[i]);\n\t\t}\n\t\tthis._updateClassName = function () {\n\t\t\telem.setAttribute(\"class\", this.toString());\n\t\t};\n\t}\n\t, classListProto = ClassList[protoProp] = []\n\t, classListGetter = function () {\n\t\treturn new ClassList(this);\n\t}\n;\n// Most DOMException implementations don't allow calling DOMException's toString()\n// on non-DOMExceptions. Error's toString() is sufficient here.\nDOMEx[protoProp] = Error[protoProp];\nclassListProto.item = function (i) {\n\treturn this[i] || null;\n};\nclassListProto.contains = function (token) {\n\ttoken += \"\";\n\treturn checkTokenAndGetIndex(this, token) !== -1;\n};\nclassListProto.add = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tif (checkTokenAndGetIndex(this, token) === -1) {\n\t\t\tthis.push(token);\n\t\t\tupdated = true;\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.remove = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t\t, index\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tindex = checkTokenAndGetIndex(this, token);\n\t\twhile (index !== -1) {\n\t\t\tthis.splice(index, 1);\n\t\t\tupdated = true;\n\t\t\tindex = checkTokenAndGetIndex(this, token);\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.toggle = function (token, force) {\n\ttoken += \"\";\n\n\tvar\n\t\t  result = this.contains(token)\n\t\t, method = result ?\n\t\t\tforce !== true && \"remove\"\n\t\t:\n\t\t\tforce !== false && \"add\"\n\t;\n\n\tif (method) {\n\t\tthis[method](token);\n\t}\n\n\tif (force === true || force === false) {\n\t\treturn force;\n\t} else {\n\t\treturn !result;\n\t}\n};\nclassListProto.toString = function () {\n\treturn this.join(\" \");\n};\n\nif (objCtr.defineProperty) {\n\tvar classListPropDesc = {\n\t\t  get: classListGetter\n\t\t, enumerable: true\n\t\t, configurable: true\n\t};\n\ttry {\n\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t} catch (ex) { // IE 8 doesn't support enumerable:true\n\t\t// adding undefined to fight this issue https://github.com/eligrey/classList.js/issues/36\n\t\t// modernie IE8-MSW7 machine has IE8 8.0.6001.18702 and is affected\n\t\tif (ex.number === undefined || ex.number === -0x7FF5EC54) {\n\t\t\tclassListPropDesc.enumerable = false;\n\t\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t\t}\n\t}\n} else if (objCtr[protoProp].__defineGetter__) {\n\telemCtrProto.__defineGetter__(classListProp, classListGetter);\n}\n\n}(window.self));\n\n}\n\n// There is full or partial native classList support, so just check if we need\n// to normalize the add/remove and toggle APIs.\n\n(function () {\n\t\"use strict\";\n\n\tvar testElement = document.createElement(\"_\");\n\n\ttestElement.classList.add(\"c1\", \"c2\");\n\n\t// Polyfill for IE 10/11 and Firefox <26, where classList.add and\n\t// classList.remove exist but support only one argument at a time.\n\tif (!testElement.classList.contains(\"c2\")) {\n\t\tvar createMethod = function(method) {\n\t\t\tvar original = DOMTokenList.prototype[method];\n\n\t\t\tDOMTokenList.prototype[method] = function(token) {\n\t\t\t\tvar i, len = arguments.length;\n\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\ttoken = arguments[i];\n\t\t\t\t\toriginal.call(this, token);\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\tcreateMethod('add');\n\t\tcreateMethod('remove');\n\t}\n\n\ttestElement.classList.toggle(\"c3\", false);\n\n\t// Polyfill for IE 10 and Firefox <24, where classList.toggle does not\n\t// support the second argument.\n\tif (testElement.classList.contains(\"c3\")) {\n\t\tvar _toggle = DOMTokenList.prototype.toggle;\n\n\t\tDOMTokenList.prototype.toggle = function(token, force) {\n\t\t\tif (1 in arguments && !this.contains(token) === !force) {\n\t\t\t\treturn force;\n\t\t\t} else {\n\t\t\t\treturn _toggle.call(this, token);\n\t\t\t}\n\t\t};\n\n\t}\n\n\ttestElement = null;\n}());\n\n}\n","const proto = Array.prototype\n\nconst ARR = {\n\tcopy(arr) {\n\t\treturn proto.slice.call(arr, 0)\n\t},\n\tempty(arr) {\n\t\tarr.length = 0\n\t\treturn arr\n\t},\n\tequals(left, right) {\n\t\tif (!Array.isArray(right)) return false\n\t\tif (left === right) return true\n\t\tif (left.length !== right.length) return false\n\t\tfor (let i = 0, l = left.length; i < l; i++) {\n\t\t\tif (left[i] !== right[i]) return false\n\t\t}\n\t\treturn true\n\t},\n\tpop(arr) {\n\t\treturn proto.pop.call(arr)\n\t},\n\tpush(arr, ...items) {\n\t\treturn proto.push.apply(arr, items)\n\t},\n\tremove(arr, item) {\n\t\tconst index = proto.indexOf.call(arr, item)\n\t\tif (index > -1) {\n\t\t\tproto.splice.call(arr, index, 1)\n\t\t\treturn item\n\t\t}\n\t},\n\treverse(arr) {\n\t\treturn proto.reverse.call(arr)\n\t},\n\trightUnique(arr) {\n\t\tconst newArr = []\n\t\tfor (let i = 0; i < arr.length; i++) {\n\t\t\tfor (let j = i + 1; j < arr.length; j++) if (arr[i] === arr[j]) j = i += 1\n\t\t\tnewArr.push(arr[i])\n\t\t}\n\t\treturn newArr\n\t},\n\tshift(arr) {\n\t\treturn proto.shift.call(arr)\n\t},\n\tslice(arr, index, length) {\n\t\treturn proto.slice.call(arr, index, length)\n\t},\n\tsort(arr, fn) {\n\t\treturn proto.sort.call(arr, fn)\n\t},\n\tsplice(arr, ...args) {\n\t\treturn proto.splice.apply(arr, args)\n\t},\n\tunshift(arr, ...items) {\n\t\treturn proto.unshift.apply(arr, items)\n\t}\n}\n\nif (window.Set && Array.from) ARR.unique = arr => Array.from(new Set(arr))\nelse ARR.unique = ARR.rightUnique\n\nexport default ARR\n","import ARR from './utils/array-helper.js'\n\nconst modificationQueue = []\nconst domQueue = []\nconst userQueue = []\nlet count = 0\n\nconst queue = handlers => modificationQueue.push(...handlers)\nconst queueDom = handler => domQueue.push(handler)\nconst onNextRender = handler => userQueue.push(handler)\n\nconst isPaused = () => count > 0\n\nconst inform = () => {\n\tcount += 1\n\treturn count\n}\n\nconst execModifications = () => {\n\tconst renderQueue = ARR.unique(modificationQueue)\n\tfor (let i of renderQueue) i()\n\tif (process.env.NODE_ENV !== 'production') console.info('[EF]', `${modificationQueue.length} modification operation(s) cached, ${renderQueue.length} executed.`)\n\tARR.empty(modificationQueue)\n}\n\nconst execDomModifications = () => {\n\tconst domRenderQueue = ARR.rightUnique(domQueue)\n\tfor (let i of domRenderQueue) i()\n\tif (process.env.NODE_ENV !== 'production') console.info('[EF]', `${domQueue.length} DOM operation(s) cached, ${domRenderQueue.length} executed.`)\n\tARR.empty(domQueue)\n}\n\nconst execUserQueue = () => {\n\tif (userQueue.length === 0) return\n\tconst userFnQueue = ARR.unique(userQueue)\n\tfor (let i of userFnQueue) i()\n\tif (process.env.NODE_ENV !== 'production') console.info('[EF]', `${userQueue.length} user operation(s) cached, ${userFnQueue.length} executed.`)\n\tARR.empty(userQueue)\n}\n\nconst exec = (immediate) => {\n\tif (!immediate && (count -= 1) > 0) return count\n\tcount = 0\n\n\tif (modificationQueue.length > 0) execModifications()\n\n\tif (domQueue.length > 0) execDomModifications()\n\n\t// Execute user queue after DOM update\n\tif (userQueue.length > 0) setTimeout(execUserQueue, 0)\n\n\treturn count\n}\n\nconst bundle = (cb) => {\n\tinform()\n\ttry {\n\t\treturn exec(cb(inform, exec))\n\t} catch (e) {\n\t\tconsole.error('[EF]', 'Error caught when executing bundle:\\n', e)\n\t\treturn exec()\n\t}\n}\n\nexport { queue, queueDom, onNextRender, inform, exec, bundle, isPaused }\n","// Enough for ef's usage, so no need for a full polyfill\nconst _assign = (ee, er) => {\n\tfor (let i in er) ee[i] = er[i]\n\treturn ee\n}\n\nconst assign = Object.assign || _assign\n\nexport { assign }\n","import { inform, exec } from './render-queue.js'\nimport { assign } from './utils/polyfills.js'\n\nconst resolveAllPath = ({_path, handlers, subscribers, innerData}) => {\n\tfor (let i of _path) {\n\t\tif (!handlers[i]) handlers[i] = {}\n\t\tif (!subscribers[i]) subscribers[i] = {}\n\t\tif (!innerData[i]) innerData[i] = {}\n\t\thandlers = handlers[i]\n\t\tsubscribers = subscribers[i]\n\t\tinnerData = innerData[i]\n\t}\n\treturn {\n\t\thandlerNode: handlers,\n\t\tsubscriberNode: subscribers,\n\t\tdataNode: innerData\n\t}\n}\n\nconst resolveReactivePath = (_path, obj, enume) => {\n\tfor (let i of _path) {\n\t\tif (!obj[i]) {\n\t\t\tconst node = {}\n\t\t\tObject.defineProperty(obj, i, {\n\t\t\t\tget() {\n\t\t\t\t\treturn node\n\t\t\t\t},\n\t\t\t\tset(data) {\n\t\t\t\t\tinform()\n\t\t\t\t\tassign(node, data)\n\t\t\t\t\texec()\n\t\t\t\t},\n\t\t\t\tconfigurable: !enume,\n\t\t\t\tenumerable: enume\n\t\t\t})\n\t\t}\n\t\tobj = obj[i]\n\t}\n\treturn obj\n}\n\nconst resolve = ({ _path, _key, data, handlers, subscribers, innerData }) => {\n\tconst parentNode = resolveReactivePath(_path, data, true)\n\tconst {handlerNode, subscriberNode, dataNode} = resolveAllPath({_path, handlers, subscribers, innerData})\n\tif (!handlerNode[_key]) handlerNode[_key] = []\n\tif (!subscriberNode[_key]) subscriberNode[_key] = []\n\tif (!Object.prototype.hasOwnProperty.call(dataNode, _key)) dataNode[_key] = ''\n\treturn { parentNode, handlerNode: handlerNode[_key], subscriberNode: subscriberNode[_key], dataNode }\n}\n\nconst resolveSubscriber = (_path, subscribers) => {\n\tconst pathArr = _path.split('.')\n\tconst key = pathArr.pop()\n\tfor (let i of pathArr) {\n\t\tif (!subscribers[i]) subscribers[i] = {}\n\t\tsubscribers = subscribers[i]\n\t}\n\treturn subscribers[key]\n}\n\nexport { resolveReactivePath, resolve, resolveSubscriber }\n","import { inform, exec } from './render-queue.js'\nimport ARR from './utils/array-helper.js'\n\nconst subscriberCallStack = []\n\nconst checkStack = subscriberNode => subscriberCallStack.indexOf(subscriberNode) >= 0\n\nconst pushStack = subscriberNode => subscriberCallStack.push(subscriberNode)\n\nconst popStack = subscriberNode => ARR.remove(subscriberCallStack, subscriberNode)\n\nconst execSubscribers = (subscriberNode, data) => {\n\t// Stop chain reaction when being called again in the context\n\t// There is no way for the caller to know it shouldn't update the node again\n\t// So this is the only method to avoid recursion\n\t// Push the current subscriberNode to stack as an identifier\n\tpushStack(subscriberNode)\n\t// Execute the subscriber function\n\tinform()\n\ttry {\n\t\tfor (const subscriber of subscriberNode) subscriber(data)\n\t} catch (e) {\n\t\tconsole.error('[EF]', 'Error caught when executing subscribers:\\n', e)\n\t}\n\texec()\n\t// Remove the subscriberNode from the stack so it could be called again\n\tpopStack(subscriberNode)\n}\n\nexport { subscriberCallStack, checkStack, pushStack, popStack, execSubscribers }\n","/* eslint-disable no-self-compare */\nconst isnan = obj => obj !== obj\n\nexport default isnan\n","import { resolve } from './resolver.js'\nimport { inform, exec, queue } from './render-queue.js'\nimport { execSubscribers } from './subscriber-call-stack.js'\nimport ARR from './utils/array-helper.js'\nimport isnan from './utils/isnan.js'\n\nconst initDataNode = ({parentNode, dataNode, handlerNode, subscriberNode, state, _key}) => {\n\tObject.defineProperty(parentNode, _key, {\n\t\tget() {\n\t\t\treturn dataNode[_key]\n\t\t},\n\t\tset(value) {\n\t\t\t// Comparing NaN is like eating a cake and suddenly encounter a grain of sand\n\t\t\tif (dataNode[_key] === value || (isnan(dataNode[_key]) && isnan(value))) return\n\t\t\tdataNode[_key] = value\n\t\t\tinform()\n\t\t\tqueue(handlerNode)\n\t\t\texec()\n\t\t\tif (subscriberNode.length > 0) execSubscribers(subscriberNode, {state, value})\n\t\t},\n\t\tenumerable: true\n\t})\n}\n\nconst initBinding = ({bind, state, handlers, subscribers, innerData}) => {\n\tconst _path = ARR.copy(bind[0])\n\tconst _key = _path.pop()\n\tconst { parentNode, handlerNode, subscriberNode, dataNode } = resolve({\n\t\t_path,\n\t\t_key,\n\t\tdata: state.$data,\n\t\thandlers,\n\t\tsubscribers,\n\t\tinnerData\n\t})\n\n\t// Initlize data binding node if not exist\n\tif (!Object.prototype.hasOwnProperty.call(parentNode, _key)) initDataNode({parentNode, dataNode, handlerNode, subscriberNode, state, _key})\n\t// Update default value\n\t// bind[1] is the default value for this node\n\tif (bind.length > 1) parentNode[_key] = bind[1]\n\n\treturn {dataNode, parentNode, handlerNode, subscriberNode, _key}\n}\n\nexport default initBinding\n","/* Get new events that works in all target browsers\n * though a little bit old-fashioned\n */\nconst getEvent = (name, props = {\n\tbubbles: false,\n\tcancelable: false\n}) => {\n\tconst event = document.createEvent('Event')\n\tevent.initEvent(name, props.bubbles, props.cancelable)\n\treturn event\n}\n\nexport default getEvent\n","const mixStr = (strs, ...exprs) => {\n\tlet string = ''\n\tfor (let i = 0; i < exprs.length; i++) string += (strs[i] + exprs[i])\n\treturn string + strs[strs.length - 1]\n}\n\nconst getVal = ({dataNode, _key}) => dataNode[_key]\n\nconst mixVal = (strs, ...exprs) => {\n\tif (!strs) return getVal(exprs[0])\n\tconst template = [strs]\n\ttemplate.push(...exprs.map(getVal))\n\treturn mixStr(...template)\n}\n\nexport { mixStr, mixVal }\n","import initBinding from './binding.js'\nimport { queue, inform, exec } from './render-queue.js'\nimport ARR from './utils/array-helper.js'\nimport getEvent from './utils/event-helper.js'\nimport { mixVal } from './utils/literals-mix.js'\n\nconst checkValidType = obj => ['number', 'boolean', 'string'].indexOf(typeof obj) > -1\n\n// SVG tags require namespace to work properly\nconst createByTag = (tag, svg) => {\n\tif (svg) return document.createElementNS('http://www.w3.org/2000/svg', tag)\n\treturn document.createElement(tag)\n}\n\nconst getElement = ({tag, ref, refs, svg}) => {\n\tconst element = createByTag(tag, svg)\n\tif (ref) Object.defineProperty(refs, ref, {\n\t\tvalue: element,\n\t\tenumerable: true\n\t})\n\treturn element\n}\n\nconst regTmpl = ({val, state, handlers, subscribers, innerData, handler}) => {\n\tif (Array.isArray(val)) {\n\t\tconst [strs, ...exprs] = val\n\t\tconst tmpl = [strs]\n\t\tconst _handler = () => handler(mixVal(...tmpl))\n\t\ttmpl.push(...exprs.map((item) => {\n\t\t\tconst {dataNode, handlerNode, _key} = initBinding({bind: item, state, handlers, subscribers, innerData})\n\t\t\thandlerNode.push(_handler)\n\t\t\treturn {dataNode, _key}\n\t\t}))\n\t\treturn _handler\n\t}\n\treturn () => val\n}\n\nconst updateOthers = ({parentNode, handlerNode, _handler, _key, value}) => {\n\t// Remove handler for this element temporarily\n\tARR.remove(handlerNode, _handler)\n\tinform()\n\tparentNode[_key] = value\n\texec()\n\t// Add back the handler\n\tARR.push(handlerNode, _handler)\n}\n\nconst addValListener = ({_handler, state, handlers, subscribers, innerData, element, key, expr}) => {\n\tconst {parentNode, handlerNode, _key} = initBinding({bind: expr, state, handlers, subscribers, innerData})\n\tconst _update = () => updateOthers({parentNode, handlerNode, _handler, _key, value: element.value})\n\tif (key === 'value') {\n\t\t// Listen to input, keyup and change events in order to work in most browsers.\n\t\telement.addEventListener('input', _update, true)\n\t\telement.addEventListener('keyup', _update, true)\n\t\telement.addEventListener('change', _update, true)\n\t\t// // Remove keyup and change listener if browser supports input event correctly\n\t\t// const removeListener = () => {\n\t\t// \telement.removeEventListener('input', removeListener, true)\n\t\t// \telement.removeEventListener('keyup', _update, true)\n\t\t// \telement.removeEventListener('change', _update, true)\n\t\t// }\n\t\t// element.addEventListener('input', removeListener, true)\n\t} else {\n\t\telement.addEventListener('change', () => {\n\t\t\t// Trigger change to the element it-self\n\t\t\telement.dispatchEvent(getEvent('ef-change-event'))\n\t\t\tif (element.tagName === 'INPUT' && element.type === 'radio' && element.name !== '') {\n\t\t\t\t// Trigger change to the the same named radios\n\t\t\t\tconst radios = document.querySelectorAll(`input[name=${element.name}]`)\n\t\t\t\tif (radios) {\n\t\t\t\t\tconst selected = ARR.copy(radios)\n\t\t\t\t\tARR.remove(selected, element)\n\n\t\t\t\t\t/* Event triggering could cause unwanted render triggers\n\t\t\t\t\t * no better ways came up at the moment\n\t\t\t\t\t */\n\t\t\t\t\tfor (let i of selected) i.dispatchEvent(getEvent('ef-change-event'))\n\t\t\t\t}\n\t\t\t}\n\t\t}, true)\n\t\t// Use custom event to avoid loops and conflicts\n\t\telement.addEventListener('ef-change-event', () => updateOthers({parentNode, handlerNode, _handler, _key, value: element.checked}))\n\t}\n}\n\nconst getAttrHandler = (element, key) => {\n\tif (key === 'class') return (val) => {\n\t\tval = `${val}`.replace(/\\s+/g, ' ').trim()\n\t\t// Remove attribute when value is empty\n\t\tif (!val) return element.removeAttribute(key)\n\t\telement.setAttribute(key, val)\n\t}\n\treturn (val) => {\n\t\t// Remove attribute when value is empty\n\t\tif (val === '') return element.removeAttribute(key)\n\t\telement.setAttribute(key, val)\n\t}\n}\n\nconst addAttr = ({element, attr, key, state, handlers, subscribers, innerData}) => {\n\tif (checkValidType(attr)) element.setAttribute(key, attr)\n\telse {\n\t\tconst handler = getAttrHandler(element, key)\n\t\tqueue([regTmpl({val: attr, state, handlers, subscribers, innerData, handler})])\n\t}\n}\n\nconst addProp = ({element, prop, key, state, handlers, subscribers, innerData}) => {\n\tif (checkValidType(prop)) element[key] = prop\n\telse {\n\t\tconst handler = (val) => {\n\t\t\telement[key] = val\n\t\t}\n\t\tconst _handler = regTmpl({val: prop, state, handlers, subscribers, innerData, handler})\n\t\tif ((key === 'value' ||\n\t\t\tkey === 'checked') &&\n\t\t\t!prop[0]) addValListener({_handler, state, handlers, subscribers, innerData, element, key, expr: prop[1]})\n\t\tqueue([_handler])\n\t}\n}\n\n\nconst rawHandler = val => val\n\nconst addEvent = ({element, event, state, handlers, subscribers, innerData}) => {\n\n\t/**\n\t *  l: listener                 : string\n\t *  m: method                   : string\n\t *  s: stopPropagation          : number/undefined\n\t *  i: stopImmediatePropagation : number/undefined\n\t *  p: preventDefault           : number/undefined\n\t *  h: shiftKey                 : number/undefined\n\t *  a: altKey                   : number/undefined\n\t *  c: ctrlKey                  : number/undefined\n\t *  t: metaKey                  : number/undefined\n\t *  u: capture                  : number/undefined\n\t *  k: keyCodes                 : array/undefined\n\t *  v: value                    : string/array/undefined\n\t */\n\tconst {l, m, s, i, p, h, a, c, t, u, k, v} = event\n\tconst _handler = regTmpl({val: v, state, handlers, subscribers, innerData, handler: rawHandler})\n\telement.addEventListener(l, (e) => {\n\t\tif (!!h !== !!e.shiftKey ||\n\t\t\t!!a !== !!e.altKey ||\n\t\t\t!!c !== !!e.ctrlKey ||\n\t\t\t!!t !== !!e.metaKey ||\n\t\t\t(k && k.indexOf(e.which) === -1)) return\n\t\tif (s) e.stopPropagation()\n\t\tif (i) e.stopImmediatePropagation()\n\t\tif (p) e.preventDefault()\n\t\tif (state.$methods[m]) state.$methods[m]({e, value: _handler(), state})\n\t\telse if (process.env.NODE_ENV !== 'production') console.warn('[EF]', `Method named '${m}' not found! Value been passed is:`, _handler())\n\t}, !!u)\n}\n\nconst createElement = ({info, state, innerData, refs, handlers, subscribers, svg}) => {\n\n\t/**\n\t *  t: tag       : string\n\t *  a: attr      : object\n\t *  p: prop      : object\n\t *  e: event     : array\n\t *  r: reference : string\n\t */\n\tconst {t, a, p, e, r} = info\n\tconst element = getElement({tag: t, ref: r, refs, svg})\n\tfor (let i in a) addAttr({element, attr: a[i], key: i, state, handlers, subscribers, innerData})\n\tfor (let i in p) addProp({element, prop: p[i], key: i, state, handlers, subscribers, innerData})\n\tfor (let i in e) addEvent({element, event: e[i], state, handlers, subscribers, innerData})\n\treturn element\n}\n\nexport default createElement\n","const proto = Node.prototype\n// const safeZone = document.createDocumentFragment()\n\nconst DOM = {\n\t// addClass(node, className) {\n\t// \tconst classes = className.split(' ')\n\t// \tnode.classList.add(...classes)\n\t// },\n\n\t// removeClass(node, className) {\n\t// \tconst classes = className.split(' ')\n\t// \tnode.classList.remove(...classes)\n\t// },\n\n\t// toggleClass(node, className) {\n\t// \tconst classes = className.split(' ')\n\t// \tconst classArr = node.className.split(' ')\n\t// \tfor (let i of classes) {\n\t// \t\tconst classIndex = classArr.indexOf(i)\n\t// \t\tif (classIndex > -1) {\n\t// \t\t\tclassArr.splice(classIndex, 1)\n\t// \t\t} else {\n\t// \t\t\tclassArr.push(i)\n\t// \t\t}\n\t// \t}\n\t// \tnode.className = classArr.join(' ').trim()\n\t// },\n\n\t// replaceWith(node, newNode) {\n\t// \tconst parent = node.parentNode\n\t// \tif (parent) proto.replaceChild.call(parent, newNode, node)\n\t// },\n\n\t// swap(node, newNode) {\n\t// \tconst nodeParent = node.parentNode\n\t// \tconst newNodeParent = newNode.parentNode\n\t// \tconst nodeSibling = node.nextSibling\n\t// \tconst newNodeSibling = newNode.nextSibling\n\t// \tif (nodeParent && newNodeParent) {\n\t// \t\tproto.insertBefore.call(nodeParent, newNode, nodeSibling)\n\t// \t\tproto.insertBefore.call(newNodeParent, node, newNodeSibling)\n\t// \t}\n\t// },\n\n\tbefore(node, ...nodes) {\n\t\tconst tempFragment = document.createDocumentFragment()\n\t\tnodes.reverse()\n\t\tfor (let i of nodes) proto.appendChild.call(tempFragment, i)\n\t\tproto.insertBefore.call(node.parentNode, tempFragment, node)\n\t},\n\n\tafter(node, ...nodes) {\n\t\tconst tempFragment = document.createDocumentFragment()\n\t\tfor (let i of nodes) proto.appendChild.call(tempFragment, i)\n\t\tif (node.nextSibling) proto.insertBefore.call(node.parentNode, tempFragment, node.nextSibling)\n\t\telse proto.appendChild.call(node.parentNode, tempFragment)\n\t},\n\n\tappend(node, ...nodes) {\n\t\tif ([1,9,11].indexOf(node.nodeType) === -1) return\n\t\tconst tempFragment = document.createDocumentFragment()\n\t\tfor (let i of nodes) proto.appendChild.call(tempFragment, i)\n\t\tproto.appendChild.call(node, tempFragment)\n\t},\n\n\t// prepend(node, ...nodes) {\n\t// \tif ([1,9,11].indexOf(node.nodeType) === -1) {\n\t// \t\treturn\n\t// \t}\n\t// \tconst tempFragment = document.createDocumentFragment()\n\t// \tnodes.reverse()\n\t// \tfor (let i of nodes) {\n\t// \t\tproto.appendChild.call(tempFragment, i)\n\t// \t}\n\t// \tif (node.firstChild) {\n\t// \t\tproto.insertBefore.call(node, tempFragment, node.firstChild)\n\t// \t} else {\n\t// \t\tproto.appendChild.call(node, tempFragment)\n\t// \t}\n\t// },\n\n\t// appendTo(node, newNode) {\n\t// \tproto.appendChild.call(newNode, node)\n\t// },\n\n\t// prependTo(node, newNode) {\n\t// \tif (newNode.firstChild) {\n\t// \t\tproto.insertBefore.call(newNode, node, node.firstChild)\n\t// \t} else {\n\t// \t\tproto.appendChild.call(newNode, node)\n\t// \t}\n\t// },\n\n\t// empty(node) {\n\t// \tnode.innerHTML = ''\n\t// },\n\n\tremove(node) {\n\t\tproto.removeChild.call(node.parentNode, node)\n\t},\n\n\t// safeRemove(node) {\n\t// \tproto.appendChild.call(safeZone, node)\n\t// }\n}\n\nexport default DOM\n","import DOM from './dom-helper.js'\nimport ARR from './array-helper.js'\nimport { inform, exec } from '../render-queue.js'\n\nconst DOMARR = {\n\tempty() {\n\t\tinform()\n\t\tfor (let i of ARR.copy(this)) i.$destroy()\n\t\texec()\n\t\tARR.empty(this)\n\t},\n\tpop() {\n\t\tif (this.length === 0) return\n\t\tconst poped = ARR.pop(this)\n\t\tpoped.$umount()\n\t\treturn poped\n\t},\n\tpush({state, key, anchor}, ...items) {\n\t\tconst elements = []\n\t\tinform()\n\t\tfor (let i of items) ARR.push(elements, i.$mount({parent: state, key}))\n\t\tif (this.length === 0) DOM.after(anchor, ...elements)\n\t\telse DOM.after(this[this.length - 1].$ctx.nodeInfo.placeholder, ...elements)\n\t\texec()\n\t\treturn ARR.push(this, ...items)\n\t},\n\tremove(item) {\n\t\tif (this.indexOf(item) === -1) return\n\t\titem.$umount()\n\t\treturn item\n\t},\n\treverse({state, key, anchor}) {\n\t\tif (this.length === 0) return this\n\t\tconst tempArr = ARR.copy(this)\n\t\tconst elements = []\n\t\tinform()\n\t\tfor (let i = tempArr.length - 1; i >= 0; i--) {\n\t\t\ttempArr[i].$umount()\n\t\t\tARR.push(elements, tempArr[i].$mount({parent: state, key}))\n\t\t}\n\t\tARR.push(this, ...ARR.reverse(tempArr))\n\t\tDOM.after(anchor, ...elements)\n\t\texec()\n\t\treturn this\n\t},\n\tshift() {\n\t\tif (this.length === 0) return\n\t\tconst shifted = ARR.shift(this)\n\t\tshifted.$umount()\n\t\treturn shifted\n\t},\n\tsort({state, key, anchor}, fn) {\n\t\tif (this.length === 0) return this\n\t\tconst sorted = ARR.copy(ARR.sort(this, fn))\n\t\tconst elements = []\n\t\tinform()\n\t\tfor (let i of sorted) {\n\t\t\ti.$umount()\n\t\t\tARR.push(elements, i.$mount({parent: state, key}))\n\t\t}\n\t\tARR.push(this, ...sorted)\n\t\tDOM.after(anchor, ...elements)\n\t\texec()\n\t\treturn this\n\t},\n\tsplice(...args) {\n\t\tif (this.length === 0) return this\n\t\tconst spliced = ARR.splice(ARR.copy(this), ...args)\n\t\tinform()\n\t\tfor (let i of spliced) i.$umount()\n\t\texec()\n\t\treturn spliced\n\t},\n\tunshift({state, key, anchor}, ...items) {\n\t\tif (this.length === 0) return this.push(...items).length\n\t\tconst elements = []\n\t\tinform()\n\t\tfor (let i of items) ARR.push(elements, i.$mount({parent: state, key}))\n\t\tDOM.after(anchor, ...elements)\n\t\texec()\n\t\treturn ARR.unshift(this, ...items)\n\t}\n}\n\nconst defineArr = (arr, info) => {\n\tObject.defineProperties(arr, {\n\t\tempty: {value: DOMARR.empty},\n\t\tpop: {value: DOMARR.pop},\n\t\tpush: {value: DOMARR.push.bind(arr, info)},\n\t\tremove: {value: DOMARR.remove},\n\t\treverse: {value: DOMARR.reverse.bind(arr, info)},\n\t\tshift: {value: DOMARR.shift},\n\t\tsort: {value: DOMARR.sort.bind(arr, info)},\n\t\tsplice: {value: DOMARR.splice},\n\t\tunshift: {value: DOMARR.unshift.bind(arr, info)}\n\t})\n\treturn arr\n}\n\nexport default defineArr\n","const typeOf = (obj) => {\n\tif (Array.isArray(obj)) return 'array'\n\treturn typeof obj\n}\n\nexport default typeOf\n","import createElement from './element-creator.js'\nimport { queue, inform, exec } from './render-queue.js'\nimport DOM from './utils/dom-helper.js'\nimport ARR from './utils/array-helper.js'\nimport defineArr from './utils/dom-arr-helper.js'\nimport typeOf from './utils/type-of.js'\nimport initBinding from './binding.js'\n\nconst bindTextNode = ({node, state, handlers, subscribers, innerData, element}) => {\n\t// Data binding text node\n\tconst textNode = document.createTextNode('')\n\tconst { dataNode, handlerNode, _key } = initBinding({bind: node, state, handlers, subscribers, innerData})\n\tconst handler = () => {\n\t\ttextNode.textContent = dataNode[_key]\n\t}\n\thandlerNode.push(handler)\n\tqueue([handler])\n\n\t// Append element to the component\n\tDOM.append(element, textNode)\n}\n\nconst updateMountingNode = ({state, children, key, anchor, value}) => {\n\tif (children[key] === value) return\n\tif (value) {\n\t\tif (value.$ctx.nodeInfo.parent && process.env.NODE_ENV !== 'production') console.warn('[EF]', 'Better detach the component before attaching it to a new component!')\n\t\tif (value.$ctx.nodeInfo.element.contains(state.$ctx.nodeInfo.element)) {\n\t\t\tif (process.env.NODE_ENV !== 'production') console.warn('[EF]', 'Cannot mount a component to it\\'s child component!')\n\t\t\treturn\n\t\t}\n\t}\n\n\tinform()\n\t// Update component\n\tif (children[key]) children[key].$umount()\n\t// Update stored value\n\tchildren[key] = value\n\tif (value) value.$mount({target: anchor, parent: state, option: 'before', key})\n\texec()\n}\n\nconst bindMountingNode = ({state, key, children, anchor}) => {\n\tObject.defineProperty(state, key, {\n\t\tget() {\n\t\t\treturn children[key]\n\t\t},\n\t\tset(value) {\n\t\t\tupdateMountingNode({state, children, key, anchor, value})\n\t\t},\n\t\tenumerable: true,\n\t\tconfigurable: true\n\t})\n}\n\nconst updateMountingList = ({state, children, key, anchor, value}) => {\n\tif (value) value = ARR.copy(value)\n\telse value = []\n\tconst fragment = document.createDocumentFragment()\n\t// Update components\n\tinform()\n\tif (children[key]) {\n\t\tfor (let j of value) {\n\t\t\tif (j.$ctx.nodeInfo.element.contains(state.$ctx.nodeInfo.element)) {\n\t\t\t\tif (process.env.NODE_ENV !== 'production') console.warn('[EF]', 'Cannot mount a component to it\\'s child component!')\n\t\t\t\treturn\n\t\t\t}\n\t\t\tj.$umount()\n\t\t\tDOM.append(fragment, j.$mount({parent: state, key}))\n\t\t}\n\t\tfor (let j of ARR.copy(children[key])) j.$umount()\n\t} else for (let j of value) DOM.append(fragment, j.$mount({parent: state, key}))\n\t// Update stored value\n\tchildren[key].length = 0\n\tARR.push(children[key], ...value)\n\t// Append to current component\n\tDOM.after(anchor, fragment)\n\texec()\n}\n\nconst bindMountingList = ({state, key, children, anchor}) => {\n\tchildren[key] = defineArr([], {state, key, anchor})\n\tObject.defineProperty(state, key, {\n\t\tget() {\n\t\t\treturn children[key]\n\t\t},\n\t\tset(value) {\n\t\t\tif (children[key] && ARR.equals(children[key], value)) return\n\t\t\tupdateMountingList({state, children, key, anchor, value})\n\t\t},\n\t\tenumerable: true,\n\t\tconfigurable: true\n\t})\n}\n\nconst resolveAST = ({node, nodeType, element, state, innerData, refs, children, handlers, subscribers, svg, create}) => {\n\tswitch (nodeType) {\n\t\tcase 'string': {\n\t\t\t// Static text node\n\t\t\tDOM.append(element, document.createTextNode(node))\n\t\t\tbreak\n\t\t}\n\t\tcase 'array': {\n\t\t\tif (typeOf(node[0]) === 'object') DOM.append(element, create({node, state, innerData, refs, children, handlers, subscribers, svg, create}))\n\t\t\telse bindTextNode({node, state, handlers, subscribers, innerData, element})\n\t\t\tbreak\n\t\t}\n\t\tcase 'object': {\n\t\t\tconst anchor = document.createTextNode('')\n\t\t\tif (node.t === 0) bindMountingNode({state, key: node.n, children, anchor})\n\t\t\telse if (node.t === 1) bindMountingList({state, key: node.n, children, anchor})\n\t\t\telse throw new TypeError(`Not a standard ef.js AST: Unknown mounting point type '${node.t}'`)\n\t\t\t// Append anchor\n\t\t\tDOM.append(element, anchor)\n\t\t\t// Display anchor indicator in development mode\n\t\t\tif (process.env.NODE_ENV !== 'production') {\n\t\t\t\tDOM.before(anchor, document.createComment(`Start of mounting point '${node.n}'`))\n\t\t\t\tDOM.after(anchor, document.createComment(`End of mounting point '${node.n}'`))\n\t\t\t}\n\t\t\tbreak\n\t\t}\n\t\tdefault: {\n\t\t\tthrow new TypeError(`Not a standard ef.js AST: Unknown node type '${nodeType}'`)\n\t\t}\n\t}\n}\n\nconst create = ({node, state, innerData, refs, children, handlers, subscribers, svg, create}) => {\n\tconst [info, ...childNodes] = node\n\tif (!svg && info.t === 'svg') svg = true\n\t// First create an element according to the description\n\tconst element = createElement({info, state, innerData, refs, handlers, subscribers, svg})\n\n\t// Append child nodes\n\tfor (let i of childNodes) resolveAST({node: i, nodeType: typeOf(i), element, state, innerData, refs, children, handlers, subscribers, svg, create})\n\n\treturn element\n}\n\nexport default create\n","const mountOptions = {\n\tBEFORE: 'before',\n\tAFTER: 'after',\n\tAPPEND: 'append',\n\tREPLACE: 'replace'\n}\n\nexport default mountOptions\n","import create from './creator.js'\nimport initBinding from './binding.js'\nimport { queueDom, inform, exec } from './render-queue.js'\nimport { resolveReactivePath, resolveSubscriber } from './resolver.js'\nimport DOM from './utils/dom-helper.js'\nimport ARR from './utils/array-helper.js'\nimport { assign } from './utils/polyfills.js'\nimport mountOptions from '../mount-options.js'\n\nconst unsubscribe = (_path, fn, subscribers) => {\n\tconst subscriberNode = resolveSubscriber(_path, subscribers)\n\tARR.remove(subscriberNode, fn)\n}\n\nconst state = class {\n\tconstructor (ast) {\n\t\tconst children = {}\n\t\tconst refs = {}\n\t\tconst innerData = {}\n\t\tconst methods = {}\n\t\tconst handlers = {}\n\t\tconst subscribers = {}\n\t\tconst nodeInfo = {\n\t\t\tplaceholder: document.createTextNode(''),\n\t\t\treplace: [],\n\t\t\tparent: null,\n\t\t\tkey: null\n\t\t}\n\n\t\t/* Detatched components will be put in the safe zone.\n\t\t * Split safe zone to each component in order to make\n\t\t * the component memory recycleable when lost reference\n\t\t */\n\t\tconst safeZone = document.createDocumentFragment()\n\n\t\tif (process.env.NODE_ENV !== 'production') nodeInfo.placeholder = document.createComment('EF COMPONENT PLACEHOLDER')\n\n\t\tconst mount = () => {\n\t\t\tif (nodeInfo.replace.length > 0) {\n\t\t\t\tfor (let i of nodeInfo.replace) DOM.remove(i)\n\t\t\t\tARR.empty(nodeInfo.replace)\n\t\t\t}\n\t\t\tDOM.before(nodeInfo.placeholder, nodeInfo.element)\n\t\t}\n\n\t\tconst ctx = {\n\t\t\tmount, refs, innerData, methods, handlers,\n\t\t\tsubscribers, nodeInfo, safeZone\n\t\t}\n\n\t\tObject.defineProperty(this, '$ctx', {\n\t\t\tget() {\n\t\t\t\treturn ctx\n\t\t\t}\n\t\t})\n\n\t\tinform()\n\t\t// Init root data node\n\t\tresolveReactivePath(['$data'], this, false)\n\n\t\tnodeInfo.element = create({node: ast, state: this, innerData, refs, children, handlers, subscribers, svg: false, create})\n\t\tDOM.append(safeZone, nodeInfo.placeholder)\n\t\tqueueDom(mount)\n\t\texec()\n\t}\n\n\tget $methods() {\n\t\tconst { methods } = this.$ctx\n\t\treturn methods\n\t}\n\n\tset $methods(newMethods) {\n\t\tconst { methods } = this.$ctx\n\t\tassign(methods, newMethods)\n\t}\n\n\tget $refs() {\n\t\treturn this.$ctx.refs\n\t}\n\n\t$mount({target, option, parent, key}) {\n\t\tconst { nodeInfo, mount } = this.$ctx\n\t\tif (typeof target === 'string') target = document.querySelector(target)\n\n\t\tinform()\n\t\tif (nodeInfo.parent) {\n\t\t\tthis.$umount()\n\t\t\tif (process.env.NODE_ENV !== 'production') console.warn('[EF]', 'Component detached from previous mounting point.')\n\t\t}\n\n\t\tif (!parent) parent = target\n\t\tif (!key) key = '__DIRECTMOUNT__'\n\t\tnodeInfo.parent = parent\n\t\tnodeInfo.key = key\n\t\tqueueDom(mount)\n\n\t\tif (!target) {\n\t\t\texec()\n\t\t\treturn nodeInfo.placeholder\n\t\t}\n\n\t\tswitch (option) {\n\t\t\tcase mountOptions.BEFORE: {\n\t\t\t\tDOM.before(target, nodeInfo.placeholder)\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase mountOptions.AFTER: {\n\t\t\t\tDOM.after(target, nodeInfo.placeholder)\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase mountOptions.REPLACE: {\n\t\t\t\tDOM.before(target, nodeInfo.placeholder)\n\t\t\t\tnodeInfo.replace.push(target)\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase mountOptions.APPEND:\n\t\t\tdefault: {\n\t\t\t\tDOM.append(target, nodeInfo.placeholder)\n\t\t\t}\n\t\t}\n\t\treturn exec()\n\t}\n\n\t$umount() {\n\t\tconst { nodeInfo, safeZone, mount } = this.$ctx\n\t\tconst { parent, key } = nodeInfo\n\t\tnodeInfo.parent = null\n\t\tnodeInfo.key = null\n\n\t\tinform()\n\t\tif (parent && key !== '__DIRECTMOUNT__' && parent[key]) {\n\t\t\tif (Array.isArray(parent[key])) ARR.remove(parent[key], this)\n\t\t\telse {\n\t\t\t\tparent[key] = null\n\t\t\t\treturn exec()\n\t\t\t}\n\t\t}\n\t\tDOM.append(safeZone, nodeInfo.placeholder)\n\t\tqueueDom(mount)\n\t\treturn exec()\n\t}\n\n\t$subscribe(pathStr, subscriber) {\n\t\tconst { handlers, subscribers, innerData } = this.$ctx\n\t\tconst _path = pathStr.split('.')\n\t\tconst { dataNode, subscriberNode, _key } = initBinding({bind: [_path], state: this, handlers, subscribers, innerData})\n\t\tinform()\n\t\t// Execute the subscriber function immediately\n\t\ttry {\n\t\t\tsubscriber({state: this, value: dataNode[_key]})\n\t\t\t// Put the subscriber inside the subscriberNode\n\t\t\tsubscriberNode.push(subscriber)\n\t\t} catch (e) {\n\t\t\tconsole.error('[EF]', 'Error caught when registering subscriber:\\n', e)\n\t\t}\n\t\texec()\n\t}\n\n\t$unsubscribe(_path, fn) {\n\t\tconst { subscribers } = this.$ctx\n\t\tunsubscribe(_path, fn, subscribers)\n\t}\n\n\t$update(newState) {\n\t\tinform()\n\t\tconst tmpState = assign({}, newState)\n\t\tif (tmpState.$data) {\n\t\t\tassign(this.$data, tmpState.$data)\n\t\t\tdelete(tmpState.$data)\n\t\t}\n\t\tif (tmpState.$methods) {\n\t\t\tassign(this.$methods, tmpState.$methods)\n\t\t\tdelete(tmpState.$methods)\n\t\t}\n\t\tassign(this, tmpState)\n\t\texec()\n\t}\n\n\t$destroy() {\n\t\tconst { nodeInfo } = this.$ctx\n\t\tinform()\n\t\tthis.$umount()\n\t\tfor (let i in this) {\n\t\t\tthis[i] = null\n\t\t\tdelete this[i]\n\t\t}\n\t\t// Push DOM removement operation to query\n\t\tqueueDom(() => {\n\t\t\tDOM.remove(nodeInfo.element)\n\t\t\tDOM.remove(nodeInfo.placeholder)\n\t\t})\n\t\t// Render\n\t\treturn exec()\n\t}\n}\n\nexport default state\n","// Import everything\nimport state from './lib/renderer.js'\nimport mountOptions from './mount-options.js'\nimport { onNextRender, inform, exec, bundle, isPaused } from './lib/render-queue.js'\nimport { version } from '../package.json'\n\nconst create = (value) => {\n\tconst ast = value\n\tconst ef = class extends state {\n\t\tconstructor(newState) {\n\t\t\tinform()\n\t\t\tsuper(ast)\n\t\t\tif (newState) this.$update(newState)\n\t\t\texec()\n\t\t}\n\t}\n\treturn ef\n}\n\nexport { create, onNextRender, inform, exec, bundle, isPaused, mountOptions, version }\n\nif (process.env.NODE_ENV !== 'production') console.info('[EF]', `ef-core v${version} initialized!`)\n","const proto = Array.prototype\n\nconst ARR = {\n\tcopy(arr) {\n\t\treturn proto.slice.call(arr, 0)\n\t},\n\tempty(arr) {\n\t\tarr.length = 0\n\t\treturn arr\n\t},\n\tequals(left, right) {\n\t\tif (!Array.isArray(right)) return false\n\t\tif (left === right) return true\n\t\tif (left.length !== right.length) return false\n\t\tfor (let i in left) if (left[i] !== right[i]) return false\n\t\treturn true\n\t},\n\tpop(arr) {\n\t\treturn proto.pop.call(arr)\n\t},\n\tpush(arr, ...items) {\n\t\treturn proto.push.apply(arr, items)\n\t},\n\tremove(arr, item) {\n\t\tconst index = proto.indexOf.call(arr, item)\n\t\tif (index > -1) {\n\t\t\tproto.splice.call(arr, index, 1)\n\t\t\treturn item\n\t\t}\n\t},\n\treverse(arr) {\n\t\treturn proto.reverse.call(arr)\n\t},\n\tshift(arr) {\n\t\treturn proto.shift.call(arr)\n\t},\n\tslice(arr, index, length) {\n\t\treturn proto.slice.call(arr, index, length)\n\t},\n\tsort(arr, fn) {\n\t\treturn proto.sort.call(arr, fn)\n\t},\n\tsplice(arr, ...args) {\n\t\treturn proto.splice.apply(arr, args)\n\t},\n\tunshift(arr, ...items) {\n\t\treturn proto.unshift.apply(arr, items)\n\t}\n}\n\nexport default ARR\n","import {inform, exec} from 'ef.js'\n\nimport 'classlist-polyfill'\n\nimport _todoapp from './tmpls/todoapp.eft'\nimport _main from './tmpls/main.eft'\nimport _todo from './tmpls/todo.eft'\nimport _footer from './tmpls/footer.eft'\n\nimport ARR from '../array-helper.js'\n\nconst todoapp = new _todoapp()\nconst main = new _main()\nconst footer = new _footer()\nlet order = 0\n\ntodoapp.main = main\ntodoapp.footer = footer\n\nconst todos = []\nconst completed = []\nconst all = []\nconst storage = []\n\nconst updateStorage = () => {\n\tlocalStorage.setItem('todos-ef', JSON.stringify(storage))\n}\n\nconst sortList = (l, r) => {\n\tif (l.$data.stored.order > r.$data.stored.order) return 1\n\treturn -1\n}\n\nconst updateList = (hash) => {\n\tinform()\n\tswitch (hash) {\n\t\tcase '#/active': {\n\t\t\tmain.todos = todos.sort(sortList)\n\t\t\tfooter.$data = {\n\t\t\t\tallSelected: '',\n\t\t\t\tactiveSelected: 'selected',\n\t\t\t\tcompletedSelected: ''\n\t\t\t}\n\t\t\tbreak\n\t\t}\n\t\tcase '#/completed': {\n\t\t\tmain.todos = completed.sort(sortList)\n\t\t\tfooter.$data = {\n\t\t\t\tallSelected: '',\n\t\t\t\tactiveSelected: '',\n\t\t\t\tcompletedSelected: 'selected'\n\t\t\t}\n\t\t\tbreak\n\t\t}\n\t\tdefault: {\n\t\t\tmain.todos = all\n\t\t\tfooter.$data = {\n\t\t\t\tallSelected: 'selected',\n\t\t\t\tactiveSelected: '',\n\t\t\t\tcompletedSelected: ''\n\t\t\t}\n\t\t}\n\t}\n\texec()\n}\n\nconst updateCount = () => {\n\tif (all.length === 0) {\n\t\tfooter.$ctx.nodeInfo.element.style.display = 'none'\n\t\tmain.$ctx.nodeInfo.element.style.display = 'none'\n\t} else {\n\t\tfooter.$ctx.nodeInfo.element.style.display = 'block'\n\t\tmain.$ctx.nodeInfo.element.style.display = 'block'\n\t}\n\n\tif (all.length !== 0 && all.length === completed.length) main.$data.allCompleted = true\n\telse main.$data.allCompleted = false\n\n\tif (completed.length === 0) footer.$refs.clear.style.display = 'none'\n\telse footer.$refs.clear.style.display = 'block'\n\tfooter.$data.count = todos.length\n\tif (todos.length > 1) footer.$data.s = 's'\n\telse footer.$data.s = ''\n}\n\nconst toggleAll = ({value}) => {\n\tinform()\n\tif (value) {\n\t\tconst _todos = ARR.copy(todos)\n\t\tfor (let i of _todos) {\n\t\t\ti.$data.stored.completed = true\n\t\t}\n\t} else if (completed.length === all.length) {\n\t\tconst _completed = ARR.copy(completed)\n\t\tfor (let i of _completed) i.$data.stored.completed = false\n\t}\n\tif (location.hash !== '#/') updateList(location.hash)\n\texec()\n}\n\nconst clear = () => {\n\tinform()\n\tfor (let i of completed) {\n\t\tARR.remove(all, i)\n\t\tARR.remove(storage, i.$data.stored)\n\t\tmain.todos.remove(i)\n\t\ti.$destroy()\n\t}\n\tcompleted.length = 0\n\tupdateCount()\n\tupdateStorage()\n\tupdateList(location.hash)\n\texec()\n}\n\nconst destroy = ({state}) => {\n\tinform()\n\tARR.remove(all, state)\n\tARR.remove(storage, state.$data.stored)\n\tARR.remove(completed, state)\n\tARR.remove(todos, state)\n\n\tstate.$destroy()\n\tupdateCount()\n\tupdateStorage()\n\tupdateList(location.hash)\n\texec()\n}\n\nconst toggleComplete = function({value: checked}) {\n\tinform()\n\tif (checked) {\n\t\tthis.$data.completed = 'completed'\n\t\tARR.remove(todos, this)\n\t\tcompleted.push(this)\n\t\tif (location.hash === '#/active') main.todos.remove(this)\n\t} else {\n\t\tthis.$data.completed = ''\n\t\ttodos.push(this)\n\t\tARR.remove(completed, this)\n\t\twindow._this_ = this\n\t\tif (location.hash === '#/completed') main.todos.remove(this)\n\t}\n\tupdateCount()\n\tupdateStorage()\n\texec()\n}\n\nconst confirm = ({e, state, value}) => {\n\tinform()\n\tconst newVal = value.trim()\n\tif (!newVal) return exec(destroy({state}))\n\tstate.$data.editing = ''\n\tstate.$data.stored.title = newVal\n\tif (e.type === 'blur') state.$data.update = ''\n\tupdateStorage()\n\texec()\n}\n\nconst cancel = ({state, value}) => {\n\tinform()\n\tstate.$data.editing = ''\n\tstate.$data.update = value\n\texec()\n}\n\nconst edit = ({state}) => {\n\tinform()\n\tstate.$data.update = state.$data.stored.title\n\tstate.$data.editing = 'editing'\n\texec()\n\tstate.$refs.edit.focus()\n}\n\nconst blur = ({state}) => {\n\tstate.$refs.edit.blur()\n}\n\nconst add = (value) => {\n\tvalue.order = order += 1\n\tvalue.completed = !!value.completed\n\tconst todo = new _todo({\n\t\t$data: {stored: value},\n\t\t$methods: {\n\t\t\tblur,\n\t\t\tedit,\n\t\t\tcancel,\n\t\t\tconfirm,\n\t\t\tdestroy\n\t\t}\n\t})\n\n\tall.push(todo)\n\tstorage.push(todo.$data.stored)\n\n\tif (!value.completed && location.hash !== '#/completed') main.todos.push(todo)\n\n\ttodo.$subscribe('stored.completed', toggleComplete.bind(todo))\n\n\tupdateCount()\n\tupdateStorage()\n\n\ttodoapp.$refs.input.focus()\n}\n\nconst addTodo = ({state, value}) => {\n\tvalue = value.trim()\n\tinform()\n\tif (!value) return exec()\n\tstate.$data.input = ''\n\tadd({\n\t\ttitle: value,\n\t\tcompleted: false\n\t})\n\texec()\n}\n\ntodoapp.$methods.addTodo = addTodo\nfooter.$methods.clear = clear\nmain.$subscribe('allCompleted', toggleAll)\n\nconst lastStorage = localStorage.getItem('todos-ef')\nif (lastStorage) {\n\tconst lastTodos = JSON.parse(lastStorage)\n\tinform()\n\tfor (let i of lastTodos) add(i)\n\texec()\n}\n\nif (!(/^#\\/(active|completed)?$/).test(location.hash)) window.location = '#/'\n\nupdateList(location.hash)\n\nwindow.addEventListener('hashchange', () => updateList(location.hash))\n\nexport default todoapp\n","import todoapp from './templates/todoapp.js'\n\ntodoapp.$mount({\n\ttarget: '.todoapp',\n\toption: 'replace'\n})\n\nwindow.todoapp = todoapp\n"],"names":["window","self","document","createElement","createElementNS","view","elemCtrProto","Element","objCtr","Object","strTrim","String","trim","this","replace","arrIndexOf","Array","indexOf","item","i","len","length","DOMEx","type","message","name","code","DOMException","checkTokenAndGetIndex","classList","token","test","call","ClassList","elem","trimmedClasses","getAttribute","classes","split","push","_updateClassName","setAttribute","toString","classListProto","classListGetter","Error","contains","add","tokens","arguments","l","updated","remove","index","splice","toggle","force","result","method","join","defineProperty","classListPropDesc","get","enumerable","configurable","ex","undefined","number","__defineGetter__","testElement","createMethod","original","DOMTokenList","prototype","_toggle","const","proto","ARR","copy","arr","slice","empty","equals","left","right","isArray","let","pop","apply","items","reverse","rightUnique","newArr","j","shift","sort","fn","args","unshift","Set","from","unique","modificationQueue","domQueue","userQueue","count","queue","handlers","queueDom","handler","inform","execUserQueue","userFnQueue","console","info","exec","immediate","renderQueue","execModifications","domRenderQueue","execDomModifications","setTimeout","assign","ee","er","resolveReactivePath","_path","obj","enume","node","set","data","subscriberCallStack","execSubscribers","subscriberNode","pushStack","subscriber","e","error","popStack","isnan","initBinding","ref","bind","_key","parentNode","subscribers","innerData","handlerNode","dataNode","resolveAllPath","hasOwnProperty","resolve","state","$data","value","initDataNode","getEvent","props","bubbles","cancelable","event","createEvent","initEvent","getVal","checkValidType","getElement","ref$1","element","tag","svg","createByTag","refs","regTmpl","val","tmpl","strs","_handler","exprs","template","map","string","updateOthers","addAttr","attr","key","removeAttribute","getAttrHandler","addProp","prop","expr","_update","addEventListener","dispatchEvent","tagName","radios","querySelectorAll","selected","checked","addValListener","rawHandler","addEvent","v","h","shiftKey","a","altKey","c","ctrlKey","t","metaKey","k","which","s","stopPropagation","stopImmediatePropagation","p","preventDefault","$methods","m","warn","u","Node","DOM","before","tempFragment","createDocumentFragment","nodes","appendChild","insertBefore","after","nextSibling","append","nodeType","removeChild","DOMARR","$destroy","poped","$umount","elements","$mount","parent","anchor","$ctx","nodeInfo","placeholder","tempArr","shifted","sorted","spliced","typeOf","bindMountingNode","children","target","option","updateMountingNode","bindMountingList","defineProperties","fragment","updateMountingList","resolveAST","createTextNode","create","textNode","textContent","bindTextNode","n","TypeError","createComment","r","childNodes","mountOptions","ast","safeZone","mount","ctx","prototypeAccessors","newMethods","methods","$refs","querySelector","$subscribe","pathStr","$unsubscribe","pathArr","resolveSubscriber","unsubscribe","$update","newState","tmpState","super","todoapp","_todoapp","main","_main","footer","_footer","order","todos","completed","all","storage","updateStorage","localStorage","setItem","JSON","stringify","sortList","stored","updateList","hash","allSelected","activeSelected","completedSelected","updateCount","style","display","allCompleted","clear","destroy","location","confirm","newVal","editing","title","update","cancel","edit","focus","blur","todo","_todo","_this_","input","addTodo","lastStorage","getItem","lastTodos","parse"],"mappings":"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"}